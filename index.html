<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Studio Rental Manager</title>
  <link rel="icon" href="favicon.ico" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }
    @media print {
      body { background-color: white !important; color: black !important; }
      header, form, .print\\:hidden { display: none !important; }
      main, .container { padding: 0 !important; margin: 0 !important; max-width: 100% !important; }
      .summary-print-container, .bg-gray-900 { background-color: transparent !important; box-shadow: none !important; ring-width: 0 !important; padding: 0 !important; margin: 1rem 0 !important; }
      .overflow-x-auto { overflow-x: visible !important; }
      table { width: 100%; font-size: 10pt; border-collapse: collapse; }
      thead { display: table-header-group; }
      th, td { border: 1px solid #ccc !important; padding: 4px; color: black !important; background-color: white !important; }
      th { background-color: #f2f2f2 !important; }
      tr { page-break-inside: avoid; }
      .text-yellow-400, .text-yellow-500, .text-white { color: black !important; }
      /* Removed problematic escaped class selectors */
      /* Simplified: */
      .bg-gray-800, .border-gray-800 { background: transparent !important; border-color: #ccc !important; }
    }
  </style>

  <!-- Firebase classic compat scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <!-- React and ReactDOM from CDN -->
  <script crossorigin src="https://esm.sh/react@18.2.0"></script>
  <script crossorigin src="https://esm.sh/react-dom@18.2.0/client"></script>
</head>
<body class="bg-black text-white">
  <div id="root"></div>
  <script type="module">
    import React from "https://esm.sh/react@18.2.0";
    import ReactDOM from "https://esm.sh/react-dom@18.2.0/client";
    import firebase from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js";
    import "https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js";

    // --- START: Firebase Configuration and Services ---
    const firebaseConfig = {
      apiKey: "AIzaSyAIHIVv6dJ0LlNqP_0qkYNok7xsbxHgdRY",
      authDomain: "studio-space-rental-database.firebaseapp.com",
      databaseURL: "https://studio-space-rental-database-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "studio-space-rental-database",
      storageBucket: "studio-space-rental-database.appspot.com",
      messagingSenderId: "176375720882",
      appId: "1:176375720882:web:ac012e2d33e8fec5ca52ab",
      measurementId: "G-NWZ18H2CVT"
    };

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const database = firebase.database();
    const rentalsRef = database.ref('rentals');
    const rentalsQuery = rentalsRef.orderByChild('shootDate');

    const calculateHours = (start, end) => {
      if (!start || !end) return 0;
      const startTime = new Date(`2000-01-01T${start}:00`);
      const endTime = new Date(`2000-01-01T${end}:00`);
      let diff = (endTime.getTime() - startTime.getTime()) / (1000 * 60 * 60);
      if (diff < 0) {
        diff += 24;
      }
      return parseFloat(diff.toFixed(2));
    };

    const addRental = (rentalData) => {
      const hours = calculateHours(rentalData.startTime, rentalData.endTime);
      const newRentalData = { ...rentalData, hours, timestamp: Date.now() };
      return rentalsRef.push(newRentalData);
    };

    const updateRental = (id, rentalData) => {
      const hours = calculateHours(rentalData.startTime, rentalData.endTime);
      const updatedRentalData = { ...rentalData, hours, timestamp: Date.now() };
      return database.ref(`rentals/${id}`).update(updatedRentalData);
    };

    const deleteRental = (id) => {
      if (!id) {
        return Promise.reject(new Error("Firebase delete failed: Provided ID is empty."));
      }
      return database.ref(`rentals/${id}`).remove();
    };
    // --- END: Firebase Configuration and Services ---

    // --- START: Constants ---
    const ADMIN_PASSWORD = '1122';
    const MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    const PAYMENT_METHODS = ['UPI', 'Cash', 'Cards'];
    const MIC_OPTIONS = ['None', 'Shure', 'DJI Wireless'];
    const DESCRIPTION_OPTIONS = {
      'studio-only': 'Studio Only',
      'studio-equipment': 'Studio with Equipment',
    };
    // --- END: Constants ---

    // --- START: Components ---

    const { useState, useEffect, useMemo } = React;

    const LoadingSpinner = () => (
      React.createElement('div', { className: "flex flex-col items-center justify-center gap-2" },
        React.createElement('div', {
          className: "w-12 h-12 rounded-full animate-spin border-4 border-solid border-yellow-500 border-t-transparent",
          role: "status",
          'aria-label': "loading"
        }),
        React.createElement('p', { className: "text-gray-400" }, "Loading rental data...")
      )
    );

    const LoginModal = ({ isOpen, onClose, onLogin }) => {
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');

      useEffect(() => {
        setPassword('');
        setError('');
      }, [isOpen]);

      const handleLoginAttempt = (e) => {
        e.preventDefault();
        if (!onLogin(password)) {
          setError('Invalid password. Please try again.');
          setPassword('');
        }
      };

      const handleKeyDown = (e) => {
        if (e.key === 'Escape') onClose();
      };

      useEffect(() => {
        if (isOpen) document.addEventListener('keydown', handleKeyDown);
        return () => document.removeEventListener('keydown', handleKeyDown);
      }, [isOpen]);

      if (!isOpen) return null;

      return React.createElement('div', { className: "fixed inset-0 bg-black/70 flex items-center justify-center z-50", onClick: onClose },
        React.createElement('div', { className: "bg-gray-900 p-8 rounded-xl shadow-lg ring-1 ring-yellow-500/50 w-full max-w-sm m-4", onClick: e => e.stopPropagation() },
          React.createElement('div', { className: "text-center mb-6" },
            React.createElement('h2', { className: "text-2xl font-bold text-white" }, "Admin Login"),
            React.createElement('p', { className: "text-gray-400 mt-1" }, "Enter the password to manage rentals.")
          ),
          React.createElement('form', { onSubmit: handleLoginAttempt },
            React.createElement('div', { className: "mb-4" },
              React.createElement('input', {
                type: "password",
                id: "admin-password",
                className: "w-full px-4 py-3 bg-gray-800 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500",
                placeholder: "Enter admin password",
                value: password,
                onChange: (e) => setPassword(e.target.value),
                autoFocus: true
              })
            ),
            error && React.createElement('p', { className: "text-red-400 text-sm text-center mb-4" }, error),
            React.createElement('button', { type: "submit", className: "w-full bg-yellow-500 text-black font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors" }, "Login")
          )
        )
      );
    };

    const getTodayDateString = () => {
      const today = new Date();
      const offset = today.getTimezoneOffset();
      const todayLocal = new Date(today.getTime() - (offset * 60 * 1000));
      return todayLocal.toISOString().split('T')[0];
    };

    const initialFormData = {
      clientName: '', shootDate: getTodayDateString(), startTime: '', endTime: '', description: 'studio-only', equipment: null,
      phoneNumber: '', paidAmount: 0, paymentMethod: 'UPI', utnNo: '', notes: ''
    };

    const initialEquipmentState = { cameras: 1, mic: 'None', lights: 2 };
    const inputBaseStyle = "bg-gray-800 border border-gray-700 text-white p-2 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 w-full";

    const RentalForm = ({ rentalToEdit, onFormSubmit }) => {
      const [formData, setFormData] = useState(initialFormData);
      const [isSubmitting, setIsSubmitting] = useState(false);
      const [error, setError] = useState('');

      useEffect(() => {
        if (rentalToEdit) {
          setFormData({ ...rentalToEdit });
          setError('');
        } else {
          setFormData(initialFormData);
        }
      }, [rentalToEdit]);

      const handleChange = (e) => setFormData(prev => ({ ...prev, [e.target.name]: e.target.value }));
      const handlePhoneNumberChange = (e) => setFormData(prev => ({ ...prev, phoneNumber: e.target.value.replace(/\D/g, '') }));
      const handleEquipmentChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, equipment: { ...(prev.equipment || initialEquipmentState), [name]: (name === 'cameras' || name === 'lights') ? parseInt(value, 10) : value } }));
      };
      const handleDescriptionChange = (e) => {
        const value = e.target.value;
        setFormData(prev => ({ ...prev, description: value, equipment: value === 'studio-equipment' ? (prev.equipment || initialEquipmentState) : null }));
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');
        if (!formData.clientName || !formData.shootDate || !formData.startTime || !formData.endTime || !formData.phoneNumber) {
          setError('Please fill in all required fields.'); return;
        }
        if (!/^\d{10}$/.test(formData.phoneNumber)) {
          setError('Phone number must be exactly 10 digits.'); return;
        }
        if (formData.startTime >= formData.endTime) {
          setError('End time must be after the start time.'); return;
        }
        setIsSubmitting(true);
        try {
          if (rentalToEdit) {
            await updateRental(rentalToEdit.id, formData);
            onFormSubmit('Rental updated successfully!');
          } else {
            await addRental(formData);
            onFormSubmit('Rental added successfully!');
          }
          setFormData(initialFormData);
        } catch (err) {
          console.error('Failed to save rental:', err);
          setError('An error occurred while saving.');
        } finally {
          setIsSubmitting(false);
        }
      };

      const isEditing = !!rentalToEdit;

      return React.createElement('div', { className: "bg-gray-900 p-6 rounded-xl shadow-lg ring-1 ring-gray-800 print:hidden mb-8" },
        React.createElement('h2', { className: "text-2xl font-bold mb-4 text-white" }, isEditing ? 'Edit Rental' : 'Add New Rental'),
        React.createElement('form', { onSubmit: handleSubmit },
          error && React.createElement('div', { className: "bg-red-900/50 border border-red-500/50 text-red-300 px-4 py-3 rounded-md mb-4", role: "alert" }, error),
          React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" },
            React.createElement('input', { type: "text", name: "clientName", value: formData.clientName, onChange: handleChange, placeholder: "Client Name", required: true, className: inputBaseStyle }),
            React.createElement('input', { type: "date", name: "shootDate", value: formData.shootDate, onChange: handleChange, required: true, className: `${inputBaseStyle} [color-scheme:dark]` }),
            React.createElement('input', { type: "time", name: "startTime", value: formData.startTime, onChange: handleChange, required: true, className: `${inputBaseStyle} [color-scheme:dark]` }),
            React.createElement('input', { type: "time", name: "endTime", value: formData.endTime, onChange: handleChange, required: true, className: `${inputBaseStyle} [color-scheme:dark]` }),
            React.createElement('input', { type: "tel", name: "phoneNumber", value: formData.phoneNumber, onChange: handlePhoneNumberChange, placeholder: "Phone Number", required: true, className: inputBaseStyle, maxLength: 10 }),
            React.createElement('input', { type: "number", name: "paidAmount", value: formData.paidAmount === 0 && !rentalToEdit ? '' : formData.paidAmount, onChange: e => setFormData(prev => ({ ...prev, paidAmount: e.target.valueAsNumber || 0 })), placeholder: "Paid Amount", min: "0", step: "0.01", required: true, className: `${inputBaseStyle} text-lg font-medium text-left` }),
            React.createElement('select', { name: "paymentMethod", value: formData.paymentMethod, onChange: handleChange, className: inputBaseStyle }, PAYMENT_METHODS.map(m => React.createElement('option', { key: m, value: m }, m))),
            React.createElement('select', { name: "description", value: formData.description, onChange: handleDescriptionChange, className: inputBaseStyle }, Object.entries(DESCRIPTION_OPTIONS).map(([k, v]) => React.createElement('option', { key: k, value: k }, v)))
          ),
          formData.description === 'studio-equipment' && React.createElement('div', { className: "mt-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700" },
            React.createElement('h3', { className: "text-lg font-semibold mb-2 text-gray-300" }, "Equipment Details"),
            React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-4" },
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "cameras", className: "block text-sm font-medium text-gray-400" }, "No. of Cameras"),
                React.createElement('input', { id: "cameras", type: "number", name: "cameras", value: formData.equipment?.cameras ?? 1, onChange: handleEquipmentChange, min: "0", className: `mt-1 text-center text-lg font-medium ${inputBaseStyle}` })
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "mic", className: "block text-sm font-medium text-gray-400" }, "Microphone"),
                React.createElement('select', { id: "mic", name: "mic", value: formData.equipment?.mic ?? 'None', onChange: handleEquipmentChange, className: `mt-1 ${inputBaseStyle}` }, MIC_OPTIONS.map(m => React.createElement('option', { key: m, value: m }, m)))
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "lights", className: "block text-sm font-medium text-gray-400" }, "No. of Lights"),
                React.createElement('input', { id: "lights", type: "number", name: "lights", value: formData.equipment?.lights ?? 2, onChange: handleEquipmentChange, min: "0", className: `mt-1 text-center text-lg font-medium ${inputBaseStyle}` })
              )
            )
          ),
          React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4 mt-4" },
            React.createElement('input', { type: "text", name: "utnNo", value: formData.utnNo, onChange: handleChange, placeholder: "UTN No (Optional)", className: inputBaseStyle }),
            React.createElement('input', { type: "text", name: "notes", value: formData.notes, onChange: handleChange, placeholder: "Notes (Optional)", className: inputBaseStyle })
          ),
          React.createElement('div', { className: "mt-6 flex items-center gap-4" },
            React.createElement('button', { type: "submit", disabled: isSubmitting, className: "bg-yellow-500 text-black font-bold px-6 py-2 rounded-md hover:bg-yellow-600 disabled:bg-yellow-400/50" }, isSubmitting ? 'Saving...' : (isEditing ? 'Update Rental' : 'Add Rental')),
            isEditing && React.createElement('button', { type: "button", onClick: () => { onFormSubmit(''); setError(''); setFormData(initialFormData); }, className: "text-gray-400 hover:text-white" }, "Cancel Edit")
          )
        )
      );
    };

    const PencilIcon = ({ className }) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className }, React.createElement('path', { d: "M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" }));
    const TrashIcon = ({ className }) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: "16", height: "16", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className },
      React.createElement('path', { d: "M3 6h18" }),
      React.createElement('path', { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" }),
      React.createElement('line', { x1: "10", y1: "11", x2: "10", y2: "17" }),
      React.createElement('line', { x1: "14", y1: "11", x2: "14", y2: "17" }));

    const formatEquipment = (equipment) => {
      if (!equipment) return '-';
      const parts = [];
      if (equipment.cameras > 0) parts.push(`Cams: ${equipment.cameras}`);
      if (equipment.mic !== 'None') parts.push(`Mic: ${equipment.mic}`);
      if (equipment.lights > 0) parts.push(`Lights: ${equipment.lights}`);
      return parts.join(', ');
    };

    const RentalList = ({ rentals, isAdmin, onEdit, onDelete }) => {
      if (!Array.isArray(rentals) || rentals.length === 0) {
        return React.createElement('div', { className: "text-center py-10 bg-gray-900 rounded-lg" },
          React.createElement('p', { className: "text-gray-400" }, "No rental records found."));
      }
      return React.createElement('div', { className: "bg-gray-900 rounded-xl shadow-lg ring-1 ring-gray-800 overflow-hidden" },
        React.createElement('div', { className: "overflow-x-auto" },
          React.createElement('table', { className: "w-full text-sm text-left text-gray-400" },
            React.createElement('thead', { className: "text-xs text-gray-300 uppercase bg-gray-800" },
              React.createElement('tr', null,
                React.createElement('th', { className: "px-6 py-3" }, "Client"),
                React.createElement('th', { className: "px-6 py-3" }, "Date"),
                React.createElement('th', { className: "px-6 py-3" }, "Timing"),
                React.createElement('th', { className: "px-6 py-3" }, "Hours"),
                React.createElement('th', { className: "px-6 py-3" }, "Equipment"),
                React.createElement('th', { className: "px-6 py-3" }, "Phone"),
                React.createElement('th', { className: "px-6 py-3" }, "Paid"),
                React.createElement('th', { className: "px-6 py-3" }, "Payment"),
                React.createElement('th', { className: "px-6 py-3" }, "UTN"),
                React.createElement('th', { className: "px-6 py-3" }, "Notes"),
                isAdmin && React.createElement('th', { className: "px-6 py-3 print:hidden" }, "Actions")
              )
            ),
            React.createElement('tbody', null, rentals.map(rental =>
              React.createElement('tr', { key: rental.id, className: "border-b border-gray-800 hover:bg-gray-800/50" },
                React.createElement('td', { className: "px-6 py-4 font-medium text-white" }, rental.clientName),
                React.createElement('td', { className: "px-6 py-4" }, rental.shootDate),
                React.createElement('td', { className: "px-6 py-4" }, `${rental.startTime} - ${rental.endTime}`),
                React.createElement('td', { className: "px-6 py-4" }, rental.hours.toFixed(2)),
                React.createElement('td', { className: "px-6 py-4" }, formatEquipment(rental.equipment)),
                React.createElement('td', { className: "px-6 py-4" }, rental.phoneNumber),
                React.createElement('td', { className: "px-6 py-4 font-semibold text-yellow-400" }, `₹${rental.paidAmount.toLocaleString('en-IN')}`),
                React.createElement('td', { className: "px-6 py-4" }, rental.paymentMethod),
                React.createElement('td', { className: "px-6 py-4" }, rental.utnNo || '-'),
                React.createElement('td', { className: "px-6 py-4 min-w-[200px]" }, rental.notes || '-'),
                isAdmin && React.createElement('td', { className: "px-6 py-4 print:hidden" },
                  React.createElement('div', { className: "flex items-center space-x-2" },
                    React.createElement('button', { onClick: () => onEdit(rental), className: "p-2 text-yellow-500 hover:bg-yellow-500/20 rounded-full" }, React.createElement(PencilIcon)),
                    React.createElement('button', { onClick: () => onDelete(rental.id), className: "p-2 text-red-500 hover:bg-red-500/20 rounded-full" }, React.createElement(TrashIcon))
                  )
                )
              )
            ))
          )
        )
      );
    };

    const Summary = ({ rentals }) => {
      const summaryData = useMemo(() => {
        if (!Array.isArray(rentals)) {
          return { totalAmount: 0, totalHours: 0, totalShoots: 0 };
        }
        return rentals.reduce((acc, rental) => {
          acc.totalAmount += rental.paidAmount || 0;
          acc.totalHours += rental.hours || 0;
          return acc;
        }, { totalAmount: 0, totalHours: 0, totalShoots: rentals.length });
      }, [rentals]);

      return React.createElement('div', { className: "mt-6 border-t border-gray-800 pt-6" },
        React.createElement('h2', { className: "text-xl font-bold mb-4 text-white" }, "Summary"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-4 text-center" },
          React.createElement('div', { className: "bg-gray-800/50 p-4 rounded-lg ring-1 ring-gray-800" },
            React.createElement('p', { className: "text-sm text-yellow-500 font-semibold" }, "Total Amount"),
            React.createElement('p', { className: "text-2xl font-bold text-white mt-1" }, `₹${summaryData.totalAmount.toLocaleString('en-IN')}`)
          ),
          React.createElement('div', { className: "bg-gray-800/50 p-4 rounded-lg ring-1 ring-gray-800" },
            React.createElement('p', { className: "text-sm text-yellow-500 font-semibold" }, "Total Hours"),
            React.createElement('p', { className: "text-2xl font-bold text-white mt-1" }, summaryData.totalHours.toFixed(2))
          ),
          React.createElement('div', { className: "bg-gray-800/50 p-4 rounded-lg ring-1 ring-gray-800" },
            React.createElement('p', { className: "text-sm text-yellow-500 font-semibold" }, "Total Shoots"),
            React.createElement('p', { className: "text-2xl font-bold text-white mt-1" }, summaryData.totalShoots)
          )
        )
      );
    };

    const App = () => {
      const [isAdmin, setIsAdmin] = useState(false);
      const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);
      const [allRentals, setAllRentals] = useState([]);
      const [editingRental, setEditingRental] = useState(null);
      const [isLoading, setIsLoading] = useState(true);
      const [selectedMonth, setSelectedMonth] = useState(String(new Date().getMonth() + 1));
      const [error, setError] = useState('');
      const [successMessage, setSuccessMessage] = useState('');

      useEffect(() => {
        const onDataChange = (snapshot) => {
          const rentalsList = [];
          snapshot.forEach((childSnapshot) => {
            const rentalData = childSnapshot.val();
            if (childSnapshot.key && rentalData) {
              const baseRental = {
                clientName: '', shootDate: '', startTime: '', endTime: '', hours: 0,
                equipment: null, phoneNumber: '', paidAmount: 0, paymentMethod: 'UPI',
                description: 'studio-only', utnNo: '', notes: '', timestamp: 0,
              };

              const normalizedRental = {
                ...baseRental,
                ...rentalData,
                id: childSnapshot.key,
                hours: Number(rentalData.hours) || 0,
                paidAmount: Number(rentalData.paidAmount) || 0,
                equipment: rentalData.equipment || null,
              };
              rentalsList.push(normalizedRental);
            }
          });
          setAllRentals(rentalsList.reverse());
          setIsLoading(false);
        };
        rentalsQuery.on('value', onDataChange, (err) => {
          console.error(err);
          setError('Failed to fetch data.');
          setIsLoading(false);
        });
        return () => rentalsQuery.off('value', onDataChange);
      }, []);

      const handleLogin = (password) => {
        if (password === ADMIN_PASSWORD) {
          setIsAdmin(true); setIsLoginModalOpen(false); return true;
        }
        return false;
      };

      const handleLogout = () => { setIsAdmin(false); setEditingRental(null); };
      const handleFormSuccess = (message) => {
        setEditingRental(null); setSuccessMessage(message);
        setTimeout(() => setSuccessMessage(''), 3000);
      };
      const handleEditRental = (rental) => {
        setEditingRental(rental); window.scrollTo({ top: 0, behavior: 'smooth' });
      };
      const handleDeleteRental = async (id) => {
        if (window.confirm('Are you sure you want to delete this rental?')) {
          try {
            await deleteRental(id);
            setSuccessMessage('Rental deleted successfully!');
            setTimeout(() => setSuccessMessage(''), 3000);
          } catch (err) {
            console.error("Failed to delete rental:", err);
            setError(`Failed to delete rental: ${err.message}`);
            setTimeout(() => setError(''), 5000);
          }
        }
      };

      const filteredRentals = useMemo(() => {
        if (selectedMonth === 'all') return allRentals;
        return allRentals.filter(r => String(new Date(r.shootDate + 'T00:00:00').getMonth() + 1) === selectedMonth);
      }, [allRentals, selectedMonth]);

      return React.createElement('div', { className: "container mx-auto p-4 md:p-8 max-w-7xl" },
        React.createElement('header', { className: "flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-8" },
          React.createElement('h1', { className: "text-2xl md:text-3xl font-bold text-white" },
            "Possible studio ", React.createElement('span', { className: "text-yellow-400" }, "-"), " Space Rental Dashboard"
          ),
          isAdmin ?
            React.createElement('button', { onClick: handleLogout, className: "bg-yellow-500 text-black font-bold py-2 px-4 rounded-md hover:bg-yellow-600 print:hidden" }, "Logout") :
            React.createElement('button', { onClick: () => setIsLoginModalOpen(true), className: "bg-gray-800 text-white font-semibold py-2 px-4 rounded-md hover:bg-gray-700 ring-1 ring-yellow-500 print:hidden" }, "Admin Login")
        ),
        React.createElement('main', null,
          successMessage && React.createElement('div', { className: "bg-green-900/70 border border-green-500/50 text-green-300 px-4 py-3 rounded-md mb-4", role: "alert" }, successMessage),
          error && React.createElement('div', { className: "bg-red-900/70 border border-red-500/50 text-red-300 px-4 py-3 rounded-md mb-4", role: "alert" }, error),
          React.createElement(LoginModal, { isOpen: isLoginModalOpen, onClose: () => setIsLoginModalOpen(false), onLogin: handleLogin }),
          isAdmin && React.createElement(RentalForm, { rentalToEdit: editingRental, onFormSubmit: handleFormSuccess }),
          React.createElement('div', { className: "my-8 bg-gray-900 p-4 sm:p-6 rounded-xl shadow-md ring-1 ring-gray-800 summary-print-container" },
            React.createElement('div', { className: "flex flex-col sm:flex-row justify-between items-center gap-4 print:hidden" },
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "month-filter", className: "font-semibold text-gray-400 mr-2" }, "Filter by Month:"),
                React.createElement('select', {
                  id: "month-filter",
                  className: "bg-gray-800 border border-gray-700 rounded-md px-2 py-1 text-white",
                  value: selectedMonth,
                  onChange: (e) => setSelectedMonth(e.target.value)
                },
                  React.createElement('option', { value: "all" }, "All Months"),
                  MONTHS.map((m, i) => React.createElement('option', { key: i, value: i + 1 }, m))
                )
              ),
              React.createElement('button', { onClick: () => window.print(), className: "w-full sm:w-auto bg-gray-700 text-white px-4 py-2 rounded-md hover:bg-gray-600" }, "Print Report")
            ),
            React.createElement(Summary, { rentals: filteredRentals })
          ),
          isLoading ? React.createElement(LoadingSpinner) : React.createElement(RentalList, { rentals: filteredRentals, isAdmin, onEdit: handleEditRental, onDelete: handleDeleteRental })
        )
      );
    };

    // --- END: Components ---

    // --- START: Render App ---
    const rootElement = document.getElementById('root');
    if (!rootElement) {
      throw new Error("Root element not found");
    }
    const root = ReactDOM.createRoot(rootElement);
    root.render(React.createElement(React.StrictMode, null, React.createElement(App)));
    // --- END: Render App ---

  </script>
</body>
</html>
